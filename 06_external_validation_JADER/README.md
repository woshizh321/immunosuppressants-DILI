Objective

To externally validate the frozen FAERS-trained LASSO-logistic DILI model in the JADER database, focusing on discrimination, calibration, and clinical interpretability.

Input

pred_prob: predicted DILI probabilities generated by FAERS Model-P (λ₁se)

DILI: binary outcome in JADER (consistent definition with FAERS)

Dataset: JADER_MASTER_PT_English_SUPERMASTER_v4_withDrugCode.parquet

Analysis Modules
1. Discrimination

AUROC

AUPRC
Assesses the model’s ability to distinguish DILI vs non-DILI reports in an independent pharmacovigilance system.

2. Overall Accuracy

Brier score
Evaluates global probability accuracy and model sharpness.

3. Calibration

Quantile-based calibration table (default: 5–10 bins)

Calibration plot (Observed vs Predicted risk)

Calibration-in-the-large
Assesses agreement between predicted and observed DILI risk in JADER.

4. Decision Curve Analysis (Optional)

Net benefit across clinically relevant risk thresholds
Explores potential clinical utility without re-training or updating the model.

Output

Saved to:

06_external_validation_JADER/outputs/evaluation/

external_metrics_summary.csv

external_calibration_table.csv

external_calibration_plot.png

external_DCA_plot.png (optional)

Notes

No model refitting or coefficient updating is performed.

Feature space and encoding strictly follow FAERS training specification.

This step constitutes a true external validation.